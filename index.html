<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Marvel's Portal of Knowledge - Homepage</title>
    <link rel="stylesheet" href="/style/style.css">
    <script src="/node_modules\js-md5\src\md5.js"></script>
    <script src="/scripts/marvelapi.js"></script>
</head>
<body onload="createURL();rngComic();rngChar();" style="background-color: darkred;"><center>
    <div style="background-color:rgb(32, 32, 32)">
        <table style="border-spacing: 5px;">
            <tr>
                <td><img src="https://upload.wikimedia.org/wikipedia/commons/b/b9/Marvel_Logo.svg" width="150px" alt=""></td><th><h1>'s Portal of Knowledge | </h1></th>
                <td><a href="/">Homepage</td>
                <td><a href="/pages/about.html">About</td>
            </tr>
                </table> 
    </div>
    <div>Search: <input style="margin: 10px;" type="text" placeholder="something marvelous..."></div>
    <table border="1">
        <tr>
            <td><button type="button" onclick="rngComic()"><b>Random Comic &#127922</b></button></td>
            <td><button type="button" onclick="rngChar()"><b>Random Character &#127922</b></button></td>
        </tr>
        
        <tr>
            <th id="comic_title"></th>
            <th id="char_name"></th>
        </tr>
        
        <tr>
            <td> <img src="" id="comic_poster" height="550px"><img></td>
            <td> <img style="margin-top: 0px;" src="" id="char_photo" height="300px"><img></td>
        </tr>
    </table>
    <div>
        <p>I do not have any rights for any of MARVEL ips Â©2024 MARVEL </p> for educational purposes only!</p>
    </div>
</center>
</body>
</html>
<script>
    
const publicKey = 'f5d1f1ec4c6252ff9f5b054433d42ffa';
const privateKey = 'fdea44270f31ee1eefbc07764be728e08cd3b613';
const apiBaseURL = "http://gateway.marvel.com//v1/public";

// Creates a URL for searching Marvel API for comics with titles starting with a given search term
function createURL(slash) {
  // Get the current timestamp
  const ts = Date.now();

  // Create a new URLSearchParams object and set the necessary query parameters
  const params = new URLSearchParams({
    ts: ts,
    apikey: publicKey,
    hash: md5(ts + privateKey + publicKey), // Generate hash for authentication
  });
  // Construct the endpoint URL for searching comics with the query parameters
  const offset = `offset=${Math.round(Math.random() * 1563)}&`;
  const endpoint = `${apiBaseURL}`+slash+`?limit=1&` + offset; // Notice the question mark to start the query parameters.

  // Combine the endpoint URL with the query parameters to form the complete API request URL
  const url = endpoint + params;

// Return the complete API request URL
  return url;
}
const url = createURL();

// fetch(url)
//   .then(response => response.json())
//   .then(data => {
//     // Handle the API response here
//     console.log(data.data.results[0].title);
//   })
//   .catch(error => {
//     // Handle any errors that occur during the API request
//     console.error(error);
//   })

function rngComic() {
  const url = createURL(`/comics`);
  const comic_title = document.getElementById("comic_title");
  const comic_poster = document.getElementById("comic_poster");
  fetch(url)
  .then(response => response.json())
  .then(data => {
    // Handle the API response here
    console.log(data.data.results[0]);
    comic_title.innerHTML = data.data.results[0].title;
    comic_poster.src = data.data.results[0].thumbnail.path+"."+data.data.results[0].thumbnail.extension;
  })
  .catch(error => {
    // Handle any errors that occur during the API request
    console.error(error);
  })
}

function rngChar() {
  const url = createURL(`/characters`);
  const char_name = document.getElementById("char_name");
  const char_photo = document.getElementById("char_photo");
  fetch(url)
  .then(response => response.json())
  .then(data => {
    // Handle the API response here
    console.log(data.data.results[0]);
    char_name.innerHTML = data.data.results[0].name;
    char_photo.src = data.data.results[0].thumbnail.path+"."+data.data.results[0].thumbnail.extension;
  })
  .catch(error => {
    // Handle any errors that occur during the API request
    console.error(error);
  })
}
</script>
